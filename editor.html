<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Blueprint Builder Editor</title>
    <link rel="stylesheet" href="./assets/style.css?v=2" />
  </head>
  <body>
    <div class="app">
      <header class="menubar" aria-label="Main menu bar">
        <div class="menu-item-wrap">
          <button class="menu-item" id="menuFileBtn" type="button" aria-haspopup="true" aria-expanded="false" aria-controls="menuFileDropdown">File</button>
          <div class="menu-dropdown" id="menuFileDropdown" role="menu" aria-label="File menu" data-open="false">
            <div class="menu-section">
              <div class="panel-header"><div class="menu-title">Project</div><button type="button" class="panel-close-btn" id="menu-file-close-btn" aria-label="Close File menu">×</button></div>
              <button id="project-save-btn" class="menu-link-btn" type="button">Save</button>
              <button id="project-load-btn" class="menu-link-btn" type="button">Load</button>
              <button id="project-reset-btn" class="menu-link-btn" type="button">Reset</button>
              <input id="project-load-input" type="file" accept=".json,application/json" class="visually-hidden" />
            </div>
          </div>
        </div>
        <div class="menu-item-wrap">
          <button class="menu-item" id="menuEditBtn" type="button" aria-haspopup="true" aria-expanded="false" aria-controls="menuEditDropdown">Edit</button>
          <div class="menu-dropdown" id="menuEditDropdown" role="menu" aria-label="Edit menu" data-open="false">
            <div class="menu-section">
              <div class="panel-header"><div class="menu-title">Groups</div><button type="button" class="panel-close-btn" id="menu-edit-close-btn" aria-label="Close Edit menu">×</button></div>
              <button id="clear-groups-btn" class="menu-link-btn" type="button">Clear All Groups</button>
            </div>
            <div class="menu-section">
              <div class="menu-title">Canvas</div>
              <label class="field-block" for="canvas-theme-select"><span>Theme</span><select id="canvas-theme-select" class="scale-input"></select></label>
              <label class="field-inline" for="custom-bg-color-picker"><span>Background color</span><input id="custom-bg-color-picker" type="color" value="#3e6478" /></label>
              <label class="field-inline" for="custom-grid-color-picker"><span>Grid color</span><input id="custom-grid-color-picker" type="color" value="#d0f1ff" /></label>
              <label class="field-block" for="theme-name-input"><span>Theme name</span><input id="theme-name-input" class="scale-input" type="text" placeholder="My Theme" /></label>
              <div class="theme-actions-row">
                <button id="save-theme-btn" class="menu-link-btn" type="button">Save Theme</button>
                <button id="delete-theme-btn" class="menu-link-btn" type="button">Delete saved theme</button>
              </div>
            </div>
            <div class="menu-section">
              <div class="menu-title">Scale</div>
              <label class="field-block" for="unit-per-cell"><span>Unit / grid</span><input id="unit-per-cell" class="scale-input" type="number" min="0.01" step="0.01" value="1" /></label>
              <label class="field-block" for="unit-name"><span>Unit</span><select id="unit-name" class="scale-input"><option value="ft" selected>ft</option><option value="in">in</option><option value="m">m</option><option value="cm">cm</option></select></label>
              <div class="scale-display" id="scale-display">1 grid = 1 ft</div>
            </div>
          </div>
        </div>
        <div class="menu-item-wrap">
          <button class="menu-item" id="menuSettingsBtn" type="button" aria-haspopup="true" aria-expanded="false" aria-controls="menuSettingsDropdown">Settings</button>
          <div class="menu-dropdown" id="menuSettingsDropdown" role="menu" aria-label="Settings menu" data-open="false">
            <div class="menu-section">
              <div class="panel-header"><div class="menu-title">Options</div><button type="button" class="panel-close-btn" id="menu-settings-close-btn" aria-label="Close Settings menu">×</button></div>
              <button class="menu-row menu-row-button" id="measurement-mode-toggle" type="button">Measurement mode: SMART</button>
              <label class="menu-row"><input id="show-grid-units-toggle" type="checkbox" />Show grid units</label>
              <label class="menu-row"><input id="continue-polyline-toggle" type="checkbox" checked />Continue polyline</label>
              <button class="menu-row menu-row-button" id="reset-tips-btn" type="button">Reset tips</button>
            </div>
            <div class="menu-section">
              <div class="menu-title">Snapping</div>
              <label class="menu-row"><input id="snap-grid-toggle" type="checkbox" checked />Snap to grid</label>
              <label class="menu-row"><input id="snap-mid-toggle" type="checkbox" checked />Snap to midpoint</label>
              <label class="menu-row"><input id="debug-snap-toggle" type="checkbox" />Debug snap</label>
              <label class="menu-row"><input id="debug-polygons-toggle" type="checkbox" />Debug polygons</label>
              <label class="menu-row"><input id="debug-regions-toggle" type="checkbox" />Debug regions</label>
              <label class="menu-row"><input id="debug-selection-drag-toggle" type="checkbox" />Debug selection/drag</label>
            </div>
          </div>
        </div>
      </header>

      <div class="main">
        <aside class="sidebar" aria-label="Editor controls">
          <section class="side-section" aria-label="Drawing tools">
            <h2 class="section-title">Tool Grid</h2>
            <button class="tool-button" id="tool-help-btn" type="button" aria-label="Open tool shortcut help">Tool Help</button>
            <div class="tool-grid">
              <button class="tool-button tool-tile" data-tool="select" type="button">Select</button>
              <button class="tool-button tool-tile" data-tool="iso-line" type="button">Line</button>
              <button class="tool-button tool-tile" data-tool="polyline" type="button">Polyline</button>
              <button class="tool-button tool-tile" data-tool="measure" type="button">Measure</button>
              <button class="tool-button tool-tile" data-tool="fill" type="button">Fill</button>
              <button class="tool-button tool-tile" data-tool="erase" type="button" title="Erase line geometry or fill regions based on mode">Erase</button>
            </div>
            <div class="tool-actions">
              <button class="tool-button" id="undo-btn" type="button">Undo</button>
              <button class="tool-button" id="redo-btn" type="button">Redo</button>
            </div>
            <div class="selection-count" id="selection-count"></div>
            <label class="field-block" for="erase-mode-toggle"><span>Erase mode</span><select id="erase-mode-toggle" class="style-select" title="Choose line or fill erase mode"><option value="line">Erase line</option><option value="fill">Erase fill</option></select></label>
            <p class="field-help">Line mode erases line geometry only. Fill mode erases fill regions only.</p>
          </section>

          <section class="side-section" aria-label="Color and style">
            <h2 class="section-title">Line Style</h2>
            <div class="recent-colors-row">
              <input id="fill-color-picker" type="color" value="#4aa3ff" aria-label="Choose color" />
              <div class="recent-row" id="recent-row"></div>
            </div>
            <label class="field-block" for="stroke-width-input"><span>Stroke width</span><select id="stroke-width-input" class="style-select"><option value="1">1</option><option value="2" selected>2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></label>
            <label class="field-block" for="fill-opacity-input"><span>Fill opacity <span id="fill-opacity-display">1.00</span></span><input id="fill-opacity-input" class="range-input" type="range" min="0" max="1" step="0.01" value="1" /></label>
          </section>
        </aside>

        <div class="canvas-wrap">
          <canvas id="canvas"></canvas>
          <div class="status-wrap">
            <div class="status" id="status">Mode: ISO</div>
            <div class="status-helper" id="status-helper">Select: click-drag to marquee, click to select.</div>
          </div>

          <div id="onboarding-overlay" class="onboarding-overlay" hidden>
            <div class="onboarding-card">
              <div class="onboarding-head">
                <strong id="onboarding-step-title">Welcome</strong>
                <button id="onboarding-dismiss-btn" class="onboarding-ghost" type="button" aria-label="Dismiss onboarding">Skip</button>
              </div>
              <p id="onboarding-step-body">Use this quick walkthrough to learn the editor basics.</p>
              <div class="onboarding-actions">
                <button id="onboarding-next-btn" class="menu-link-btn" type="button">Next</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="selection-bar" class="selection-bar" hidden>
      <div id="selection-bar-count" class="selection-bar-count">Selection (0)</div>
      <label class="selection-bar-keep"><input id="selection-keep-checkbox" type="checkbox" /> Keep selecting</label>
      <div class="selection-bar-actions">
        <button id="selection-done-btn" class="menu-link-btn" type="button">Done</button>
        <button id="selection-delete-btn" class="menu-link-btn" type="button">Delete</button>
        <button id="btnGroup" class="menu-link-btn" type="button">Group</button>
      </div>
    </div>


    <div id="z-order-context-menu" class="z-order-context-menu" hidden>
      <div class="panel-header panel-header--menu"><div class="menu-title">Arrange</div><button type="button" class="panel-close-btn" id="z-order-menu-close-btn" aria-label="Close arrange menu">×</button></div>
      <button id="z-order-front-btn" class="z-order-context-item" type="button">Bring to Front</button>
      <button id="z-order-forward-btn" class="z-order-context-item" type="button">Bring Forward</button>
      <button id="z-order-backward-btn" class="z-order-context-item" type="button">Send Backward</button>
      <button id="z-order-back-btn" class="z-order-context-item" type="button">Send to Back</button>
    </div>

    <script type="module" src="./src/script.js?v=2"></script>
  </body>
</html>
